

# 康托展开

康托展开（Cantor expansion）是一种将自然数映射到自然数序列的数学方法，通常用于组合数学中处理排列的问题。康托展开能够为给定的排列（即一个数列，其中每个数都是不同的）生成一个唯一的自然数，这个数称为康托数（Cantor number）或康托指数。同时，这个方法也可以用于将一个自然数展开为特定的排列。
康托展开的过程如下：
假设有一个由 $n$ 个不同数字组成的排列 $P = [a_1, a_2, ..., a_n]$，排列中的每个数字 $a_i$ 都是从 1 到 $n$ 的一个整数，且每个数字在排列中只出现一次。
康托展开的步骤是：

1. 对于排列中的每个位置 $i$（从 1 到 $n$），计算在该位置之前有多少个数字小于 $a_i$。

2. 将这些小于 $a_i$ 的数字的数量乘以 $(n - i)!$（即从 $n - i + 1$ 到 $n$ 的所有整数的阶乘），并将所有的结果相加。


用数学公式表示，排列 $P$ 的康托数 $C(P)$ 可以这样计算：
$C(P) = \sum_{i=1}^{n} (m_i \times (n - i)!) $
其中 $m_i$ 是在位置 $i$ 之前小于 $a_i$ 的数字的数量。
例如，对于排列 $P = [3, 1, 2]$，康托数 $C(P)$ 的计算过程如下：

- 对于 $a_1 = 3$，在它之前没有比它小的数字，所以 $m_1 = 0$。

- 对于 $a_2 = 1$，在它之前有一个比它大的数字（3），所以 $m_2 = 0$。

- 对于 $a_3 = 2$，在它之前有一个比它小的数字（1），所以 $m_3 = 1$。


因此，$ C(P) = 0 \times 2! + 0 \times 1! + 1 \times 0! = 0 + 0 + 1 = 1 $

康托展开的一个应用是在计算排列的字典序中的位置。例如，在上述例子中，排列 $[3, 1, 2]$ 在所有3个数字的排列中是第二个（按照字典序）。康托展开还可以用于证明某些组合恒等式，以及解决与排列相关的计数问题。



## 逆康托展开



对于一个给定的$k$ ，求将自然数$1$ ~$k$ 所有的排列按照字典序从小到大排序后位于第$n$ 的排列。排序从$0$ 开始编号。

由于$n$ 有可能很大，所以现在将给你$k$ 个数，分别为$S_1$ ，$S_2$ ，……，$S_k$ ，规定$n$ 的计算方式为

$n=\sum_{i=1}^k S_i \times (k-i)!$

接下来$T$ 组数据，每组数据的第一行包含$1$ 个数$k$ （$1 \leq k \leq 500000$ ），第二行包含$k$ 个整数，第$i$ 个整数表示$S_i$ （$0 \leq S_i \leq k-i$ ）。

对于输入文件的每组数据，输出一行，包含$k$ 个数，为对应的$1$ ~$n$ 的排列。

---

我们考虑给出的信息，对于每一组数据，从前往后考虑每一个S_i，其实就是要我们输出当前还存在的数字中第S_i打的数字。权值线段树。

