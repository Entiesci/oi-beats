## **同余最短路**

P2371 [国家集训队] 墨墨的等式

[www.luogu.com.cn](https://www.luogu.com.cn/problem/P2371)


**思路**

首先我们应该想到的是完全背包吧……但b过大，我们不能这样做。

[www.luogu.com.cn](https://www.luogu.com.cn/blog/xuxing/solution-p2371)


Std

```C++
/*
CB Ntsc
*/

#include<bits/stdc++.h>
using namespace std;
#define int long long
#define mp make_pair
#define pii pair<int,int> 

const int N=5e5+5;
const int INF=1e9+5;
const int MOD=998244353;
bool f1;
struct node{
	int nxt,dis;
};
vector<node>e[N];
priority_queue<pair<int,int> >pq;
int n,vis[N],dis[N],m,k,s,t;
int mn=INF,l,r,a[N];
bool f2;
#define rd read()
inline int read()
{
	int xx=0,ff=1;
	char ch=getchar();
	while(ch<'0'||ch>'9') {if(ch=='-') ff=-1;ch=getchar();}
	while(ch>='0'&&ch<='9') xx=xx*10+(ch-'0'),ch=getchar();
	return xx*ff;
}
inline void write(int out)
{
	if(out<0) putchar('-'),out=-out;
	if(out>9) write(out/10);
	putchar(out%10+'0');
}

void add(int a,int b,int c){
	e[a].push_back({b,c});
}


void djstr(int rt) {
	pq.push(make_pair(0,rt));
	int u=rt;	//先从起点开始查
	memset(dis,0x3f3f,sizeof dis);	//初始化边权

	dis[rt]=0;
	
	while(pq.size()) {	//搜完全图
		
		u=pq.top().second;
		
		pq.pop();
		if(vis[u])continue;//记得continue
		vis[u]=1;
		for(int i=0;i<e[u].size();i++){
			int v=e[u][i].nxt,w=e[u][i].dis;
			if(!vis[v]&&dis[u]+w<dis[v]){
				dis[v]=dis[u]+w;	//更新
				pq.push(make_pair(-dis[v],v));
			}
		}
	}
}

int query(int x){
	int res=0;
	for(int i=0;i<mn;i++){
		if(dis[i]<=x)res+=(x-dis[i])/mn+1;
	}
	return res;
}
signed main(){

	// freopen("school.in", "r", stdin);
	// freopen("school.out", "w", stdout);

	n=rd;l=rd;r=rd;
	for(int i=1;i<=n;i++){
		int x=rd;
		if(x){//跳过a[i]=0
			a[++m]=x;
			mn=min(mn,x);
		}
	}
	
	
	
	for(int i=0;i<mn;i++){
		for(int j=1;j<=m;j++){
			if(a[j]!=mn)add(i,(i+a[j])%mn,a[j]);
		}
	}
//	cerr<<mn<<endl;
	djstr(0);
//	cerr<<"ok\n";
	cout<<query(r)-query(l-1);


    return 0;
}

/*
5 3 3
2 3 4 7 6
*/
```

### 扩展练习

[www.luogu.com.cn](https://www.luogu.com.cn/problem/P3403)


